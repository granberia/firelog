---
title: fs.readdirSync로 파일을 읽을 때 숫자로 된 파일명 정렬이 깨지는 현상 대응
date: 2025-12-08 16:41:15 +0900
categories: [개발]
tags: [개발]
image:
  path: /img/2025-12-08-fs.readdirSync로-파일을-읽을-때-숫자로-된-파일명-정렬이-깨지는-현상-대응/image.png
  alt: "alt text"
---


LLM에 사용할 지식 베이스 갱신 스크립트를 사용하다가 파일명 정렬이 이상한 걸 발견했다.

기존에 지식 베이스 파일 목록을 가져올 때 사용하는 코드는 아래와 같다.

```js
const files = fs
  .readdirSync(fullDir)
  .filter((file) => fs.statSync(path.join(fullDir, file)).isFile());
```

그리고 탐색기에서 지식 베이스 파일들은 아래와 같은 순서로 표시된다.

![alt text](/img/2025-12-08-fs.readdirSync로-파일을-읽을-때-숫자로-된-파일명-정렬이-깨지는-현상-대응/image.png)

하지만 위 코드로 파일 목록을 가져와 차례대로 출력했을 때 아래의 순서대로 나오는 문제가 있었다.
- episode_1.md
- episode_10.md
- episode_11.md
- episode_12.md
- episode_13.md
- episode_14.md
- episode_15.md
- episode_16.md
- episode_17.md
- episode_18.md
- episode_19.md
- episode_2.md
- episode_20.md
- episode_21.md

`fs.readdirSync` 의 파일 정렬이 윈도우 탐색기랑 조금 다른 것 같아서 제미니 3에 확인해보았더니 아래와 같은 수정 사항을 제안해주었다.

```js
const files = fs
  .readdirSync(fullDir)
  .filter((file) => fs.statSync(path.join(fullDir, file)).isFile())
  .sort((a, b) => a.localeCompare(b, undefined, { numeric: true, sensitivity: 'base' }));
```

자바스크립트에 `localeCompare` 라는 메서드가 있었다고? 신기하다.

```md
### 변경 사항 설명

*   **`a.localeCompare(b, undefined, { numeric: true, sensitivity: 'base' })`**:
    *   **`numeric: true`**: 문자열 안에 포함된 숫자를 문자가 아닌 실제 숫자 값으로 비교합니다. (예: "2" < "19"가 성립됨)
    *   **`sensitivity: 'base'`**: 대소문자를 구분하지 않고 정렬합니다 (운영체제 파일 시스템과 유사한 동작을 위해 추가).
```

윈도우 탐색기랑 동일한 순서를 가지기 위해서는 `sensitivity` 옵션도 같이 사용해야 한다고 한다.

수정된 코드를 사용해서 이슈 해결.
